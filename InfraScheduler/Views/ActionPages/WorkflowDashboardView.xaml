<UserControl x:Class="InfraScheduler.Views.WorkflowDashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:InfraScheduler.Views"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1200"
             FontFamily="Segoe UI">
    
    <UserControl.Resources>
        <!-- Dashboard-specific styles -->
        <Style x:Key="DashboardCardStyle" TargetType="Border" BasedOn="{StaticResource CardStyle}">
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>

        <Style x:Key="WorkflowStepCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource SurfaceColor}"/>
            <Setter Property="BorderBrush" Value="{StaticResource DividerColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
            <Setter Property="Effect" Value="{StaticResource CardShadowEffect}"/>
        </Style>

        <Style x:Key="StepButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="Margin" Value="0,8,0,0"/>
        </Style>
    </UserControl.Resources>
    
    <Grid Background="#FAFAFA">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Windows 10 Header with Navigation Path -->
        <Border Grid.Row="0" Background="White" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="24,16,24,16">
            <StackPanel>
                <!-- Navigation Breadcrumb -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <TextBlock Text="Home" Foreground="#0078D4" FontSize="14" FontWeight="Normal"/>
                    <TextBlock Text=" > " Foreground="#666666" FontSize="14" Margin="8,0,8,0"/>
                    <TextBlock Text="Main" Foreground="#666666" FontSize="14" Margin="0,0,8,0"/>
                    <TextBlock Text=" > " Foreground="#666666" FontSize="14" Margin="0,0,8,0"/>
                    <TextBlock Text="Dashboard" Foreground="#666666" FontSize="14" FontWeight="Normal"/>
                </StackPanel>
                
                <!-- Main Heading -->
                <TextBlock Text="Equipment Workflow Dashboard" FontSize="32" FontWeight="Light" Foreground="#333333"/>
                
                <!-- Subtitle -->
                <TextBlock Text="Monitor and manage equipment workflow from job acceptance to completion" FontSize="16" Foreground="#666666" Margin="0,8,0,0"/>
            </StackPanel>
        </Border>

        <!-- Content Area -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Margin="24">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Job List Card -->
                <Border Grid.Column="0" Background="White" CornerRadius="4" Padding="24" Margin="0,0,16,0">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Job List Header -->
                        <Border Grid.Row="0" Background="#0078D4" Padding="20" Margin="-24,-24,-24,16" CornerRadius="4,4,0,0">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Grid.Column="0" 
                                           Text="Jobs with Equipment Requirements" 
                                           FontSize="18" 
                                           FontWeight="Medium" 
                                           Foreground="White"/>
                                <Button Grid.Column="1" 
                                        Content="Refresh" 
                                        Command="{Binding RefreshCommand}" 
                                        Background="White" Foreground="#0078D4" 
                                        Padding="16,8" BorderThickness="0" FontSize="14"/>
                            </Grid>
                        </Border>

                        <!-- Job List -->
                        <DataGrid Grid.Row="1" 
                                  ItemsSource="{Binding WorkflowStatuses}" 
                                  SelectedItem="{Binding SelectedWorkflowStatus}" 
                                  Background="White" BorderBrush="#E0E0E0" BorderThickness="1"
                                  AutoGenerateColumns="False"
                                  GridLinesVisibility="Horizontal"
                                  HeadersVisibility="Column"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="False"
                                  CanUserReorderColumns="True"
                                  CanUserResizeColumns="True"
                                  CanUserResizeRows="False"
                                  SelectionMode="Single"
                                  SelectionUnit="FullRow">
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#F5F5F5"/>
                                    <Setter Property="Foreground" Value="#333333"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Padding" Value="12,8"/>
                                    <Setter Property="BorderBrush" Value="#E0E0E0"/>
                                    <Setter Property="BorderThickness" Value="0,0,1,0"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.CellStyle>
                                <Style TargetType="DataGridCell">
                                    <Setter Property="Padding" Value="12,8"/>
                                    <Setter Property="BorderBrush" Value="#E0E0E0"/>
                                    <Setter Property="BorderThickness" Value="0,0,1,1"/>
                                </Style>
                            </DataGrid.CellStyle>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Job ID" Binding="{Binding JobId}" Width="80"/>
                                <DataGridTextColumn Header="Job Name" Binding="{Binding JobName}" Width="200"/>
                                <DataGridTextColumn Header="Site" Binding="{Binding SiteName}" Width="150"/>
                                <DataGridTextColumn Header="Client" Binding="{Binding ClientName}" Width="150"/>
                                <DataGridTextColumn Header="Job Status" Binding="{Binding JobStatus}" Width="120"/>
                                <DataGridTextColumn Header="Batch Status" Binding="{Binding BatchStatus}" Width="140"/>
                                <DataGridTextColumn Header="Equipment Progress" Width="220">
                                    <DataGridTextColumn.ElementStyle>
                                        <Style TargetType="TextBlock">
                                            <Setter Property="Text" Value="{Binding ReceivedLines, StringFormat='{}{0}/{1} Received, {2} Shipped, {3} Installed'}"/>
                                            <Setter Property="FontFamily" Value="Segoe UI"/>
                                            <Setter Property="FontSize" Value="13"/>
                                        </Style>
                                    </DataGridTextColumn.ElementStyle>
                                </DataGridTextColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>

                <!-- Workflow Actions Card -->
                <Border Grid.Column="1" Background="White" CornerRadius="4" Padding="24" Width="320">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Actions Header -->
                        <Border Grid.Row="0" Background="#0078D4" Padding="20" Margin="-24,-24,-24,16" CornerRadius="4,4,0,0">
                            <TextBlock Text="Workflow Actions" 
                                       FontSize="18" 
                                       FontWeight="Medium" 
                                       Foreground="White"/>
                        </Border>

                        <!-- Actions Panel -->
                        <ScrollViewer Grid.Row="1" 
                                      VerticalScrollBarVisibility="Auto" 
                                      Padding="0">
                            <StackPanel>
                                
                                <!-- Selected Job Info -->
                                <Border Background="#FAFAFA" BorderBrush="#E0E0E0" BorderThickness="1" 
                                        CornerRadius="4" Padding="16" Margin="0,0,0,12">
                                    <StackPanel>
                                        <TextBlock Text="Selected Job:" 
                                                   FontWeight="Medium" 
                                                   Margin="0,0,0,8"/>
                                        <TextBlock Text="{Binding SelectedWorkflowStatus.JobName}" 
                                                   FontSize="16" 
                                                   Foreground="#333333"/>
                                        <TextBlock Text="{Binding SelectedWorkflowStatus.SiteName}" 
                                                   FontSize="14" 
                                                   Foreground="#666666"/>
                                    </StackPanel>
                                </Border>

                                <!-- Step 1: Accept Job -->
                                <Border Background="#E8F5E8" BorderBrush="#4CAF50" BorderThickness="1" 
                                        CornerRadius="4" Padding="16" Margin="0,0,0,12">
                                    <StackPanel>
                                        <TextBlock Text="Step 1: Accept Job" 
                                                   FontWeight="Medium" 
                                                   Foreground="#2E7D32"/>
                                        <TextBlock Text="Create equipment batch from job requirements" 
                                                   FontSize="13" 
                                                   Foreground="#388E3C" 
                                                   Margin="0,4,0,12"/>
                                        <Button Content="Accept Job" 
                                                Command="{Binding AcceptJobCommand}" 
                                                IsEnabled="{Binding SelectedWorkflowStatus.CanBeAccepted}" 
                                                Background="#4CAF50" 
                                                Foreground="White"
                                                Padding="16,8" BorderThickness="0" FontSize="14"/>
                                    </StackPanel>
                                </Border>

                                <!-- Step 2: Receive Equipment -->
                                <Border Background="#FFF8E1" BorderBrush="#FF9800" BorderThickness="1" 
                                        CornerRadius="4" Padding="16" Margin="0,0,0,12">
                                    <StackPanel>
                                        <TextBlock Text="Step 2: Receive Equipment" 
                                                   FontWeight="Medium" 
                                                   Foreground="#F57C00"/>
                                        <TextBlock Text="Receive equipment at SDS warehouse" 
                                                   FontSize="13" 
                                                   Foreground="#FF8F00" 
                                                   Margin="0,4,0,12"/>
                                        <Button Content="Open Receiving View" 
                                                Command="{Binding OpenReceivingViewCommand}" 
                                                IsEnabled="{Binding SelectedWorkflowStatus.CanBeReceived}" 
                                                Background="#FF9800" 
                                                Foreground="White"
                                                Padding="16,8" BorderThickness="0" FontSize="14"/>
                                    </StackPanel>
                                </Border>

                                <!-- Step 3: Ship Equipment -->
                                <Border Background="#E3F2FD" BorderBrush="#2196F3" BorderThickness="1" 
                                        CornerRadius="4" Padding="16" Margin="0,0,0,12">
                                    <StackPanel>
                                        <TextBlock Text="Step 3: Ship Equipment" 
                                                   FontWeight="Medium" 
                                                   Foreground="#1976D2"/>
                                        <TextBlock Text="Mark equipment as shipped to site" 
                                                   FontSize="13" 
                                                   Foreground="#2196F3" 
                                                   Margin="0,4,0,12"/>
                                        <Button Content="Open Shipping View" 
                                                Command="{Binding OpenShippingViewCommand}" 
                                                IsEnabled="{Binding SelectedWorkflowStatus.CanBeShipped}" 
                                                Background="#2196F3" 
                                                Foreground="White"
                                                Padding="16,8" BorderThickness="0" FontSize="14"/>
                                    </StackPanel>
                                </Border>

                                <!-- Step 4: Track Installation -->
                                <Border Background="#F5F5F5" BorderBrush="#9E9E9E" BorderThickness="1" 
                                        CornerRadius="4" Padding="16" Margin="0,0,0,12">
                                    <StackPanel>
                                        <TextBlock Text="Step 4: Track Installation" 
                                                   FontWeight="Medium" 
                                                   Foreground="#616161"/>
                                        <TextBlock Text="Monitor equipment installation through tasks" 
                                                   FontSize="13" 
                                                   Foreground="#757575" 
                                                   Margin="0,4,0,12"/>
                                        <Button Content="View Tasks" 
                                                Command="{Binding ViewTasksCommand}" 
                                                Background="#9E9E9E" 
                                                Foreground="White"
                                                Padding="16,8" BorderThickness="0" FontSize="14"/>
                                    </StackPanel>
                                </Border>

                                <!-- Step 5: Close Job -->
                                <Border Background="#FFEBEE" BorderBrush="#F44336" BorderThickness="1" 
                                        CornerRadius="4" Padding="16" Margin="0,0,0,12">
                                    <StackPanel>
                                        <TextBlock Text="Step 5: Close Job" 
                                                   FontWeight="Medium" 
                                                   Foreground="#C62828"/>
                                        <TextBlock Text="Close job and update site ledger" 
                                                   FontSize="13" 
                                                   Foreground="#D32F2F" 
                                                   Margin="0,4,0,12"/>
                                        <Button Content="Open Close-Out View" 
                                                Command="{Binding OpenCloseOutViewCommand}" 
                                                IsEnabled="{Binding SelectedWorkflowStatus.CanBeClosed}" 
                                                Background="#F44336" 
                                                Foreground="White"
                                                Padding="16,8" BorderThickness="0" FontSize="14"/>
                                    </StackPanel>
                                </Border>

                                <!-- Step 6: Site Inventory -->
                                <Border Background="#E0F2F1" BorderBrush="#009688" BorderThickness="1" 
                                        CornerRadius="4" Padding="16" Margin="0,0,0,12">
                                    <StackPanel>
                                        <TextBlock Text="Step 6: Site Inventory" 
                                                   FontWeight="Medium" 
                                                   Foreground="#00695C"/>
                                        <TextBlock Text="View site equipment inventory" 
                                                   FontSize="13" 
                                                   Foreground="#00796B" 
                                                   Margin="0,4,0,12"/>
                                        <Button Content="View Site Inventory" 
                                                Command="{Binding ViewSiteInventoryCommand}" 
                                                Background="#009688" 
                                                Foreground="White"
                                                Padding="16,8" BorderThickness="0" FontSize="14"/>
                                    </StackPanel>
                                </Border>

                                <!-- System Actions -->
                                <Border Background="#FAFAFA" BorderBrush="#E0E0E0" BorderThickness="1" 
                                        CornerRadius="4" Padding="16">
                                    <StackPanel>
                                        <TextBlock Text="System Actions" 
                                                   FontWeight="Medium" 
                                                   Foreground="#333333"/>
                                        <Button Content="Rebuild Snapshots" 
                                                Command="{Binding RebuildSnapshotsCommand}" 
                                                Background="#673AB7" 
                                                Foreground="White"
                                                Padding="16,8" BorderThickness="0" FontSize="14" Margin="0,8,0,0"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </Border>
            </Grid>
        </ScrollViewer>
    </Grid>
</UserControl> 